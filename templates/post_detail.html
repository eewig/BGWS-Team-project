{% extends 'base.html' %}
{% load static %}
{% load posts_extras %}

{% block head %}
	<link rel="stylesheet" type="text/css" href="{% static 'css/post_detail.css' %}">
{% endblock %}

{% block content %}

<div class="article-entry">
	<h6 class="text-muted">Posted by <a href="{% url 'user_profile' post.author.id %}">
      {{ post.author }}
      </a> | {{ post.created|date:"d.m.Y H:i" }} </h6>
	<h1>{{ post.title }}</h2>
    <p>{{ post.body }}</p>
  <div id="likes-{{ post.id }}" class="d-flex align-items-stretch">
	  {% if post|isliked:user %}
	    <img src="{% static 'posts/like_active.png' %}" onClick="likePost('{{ post.id }}')" width="25" height="25">
	  {% else %}
	    <img src="{% static 'posts/like.png' %}" onClick="likePost('{{ post.id }}')" width="25" height="25">
	  {% endif %}
	  <p class="text-muted likes-number" style="margin-left: 3px;">{{ post|countlikes }}</p>

	</div>
	{% if post.author == user %}
		<a href="{% url 'post_edit' post.id %}">Edit</a>
		<a href="{% url 'post_delete' post.id %}">Delete</a>
	{% endif %}
</div>

<p>Back to <a href="{% url 'home' %}">All Posts</a>.</p>


<div class="card-footer">
	<form action="{% url 'post_detail' post.id %}" method="post">
		{% csrf_token %}
		<div class="mb-3">
			<label for="{{ form.comment.id_for_label }}">{{ form.comment.label }}: </label>
			{{ form.comment }}
		</div>
		<div class="mb-3">
			<button class="btn btn-primary ml-2" type="submit">Send</button>
		</div>
	</form>
</div>


{% for comment in post.comments.all %}
	<div class="card" style="margin-top: 1vh;">
	  <div class="card-header">
	  	<a href="{% url 'user_profile' comment.author.id %}">
	  		{{ comment.author.username }}
	  	</a> | <span class="text-muted">{{ comment.created_on|date:"d.m.Y H:i" }}</span>
	  </div>
	  <div class="card-body">
	    <p class="card-text">{{ comment.comment }}</p>
	  </div>
	</div>
{% endfor %}
<script type="text/javascript" src="{% static 'js/script.js' %}"></script>
{% endblock content %}
